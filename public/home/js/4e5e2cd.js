!function(e){function t(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var a={};t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="//cache.soso.com/wenwen/deploy/js/zhuzhan/pc/ask/",t(t.s=1)}([function(e,t){e.exports=preact},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){if("string"==typeof e&&"question"==T){var t=$(".add_pic");$(".add_pic").hasClass("hide")&&(t=$(".add_ask_image")),pageUtils.Dialog.showTips(e,{remove:!0,type:"white",popup:t})}}function l(){return"question"==T?{add:"addPic",loadingWrap:"picUpload",picShowWrap:"picShowWrap",forms:["uploadImgForm"]}:{add:"",loadingWrap:"",picShowWrap:"",forms:[]}}function c(){if("question"==T)return 5}function d(e){T=e}function p(){var e=l();if("question"===T){var t=$("#"+e.picShowWrap),a='<div class="pic-section load_image"><a href="javascript:;" class="pic-tab"></a><div class="thumb-loading"><span>涓婁紶涓�</span></div></div>';t.find(".fail_image").length?t.find(".fail_image").first().replaceWith(a):t.find(".load_image").length||t.removeClass("hide").find(".add_ask_image").before(a)}}function u(){var e=l();"question"==T&&$("#"+e.picShowWrap).find(".load_image").remove()}function f(e){try{var t=e;if("string"==typeof e&&(t=JSON.parse(e)),0===t.result){var a=t.fname;if("string"==typeof a)return"//pic.wenwen.soso.com/p/"+a.substr(0,8)+"/"+a}else s("鍥剧墖涓婁紶澶辫触锛岃閲嶆柊涓婁紶锛�"),u()}catch(e){}}function h(e){var t=new XMLHttpRequest;t.onload=function(e){E(e.target.responseText)},t.onerror=function(e){I(e.responseText)},t.open("POST","/submit/qun/upload-pic",!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest");var a=new FormData;a.append("pic",e),a.append("formids","If_1,pic"),a.append("submitmode","submit"),a.append("submitname",""),a.append("If_1","F"),t.send(a)}function g(){for(var e=l(),t=0;t<e.forms.length;t++)$("#"+e.forms[t])[0].reset()}function m(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];if(-1!==n.type.indexOf("image")){Math.floor(n.size/1024/1024)>5?s("鍥剧墖澶у皬涓嶈兘瓒呰繃5M,璇烽噸鏂颁笂浼�"):t.push(n)}else s(n.name+" 涓嶆槸鍥剧墖锛�")}if(!v(t.length))return g(),!1;if(t.length>0)for(var i=0;i<t.length;i++)!function(e){p();var a=t[e];h(a,null,function(){window.badjs.report(new Error("upload image fail! PC  "+a.name),EX_TYPE.imgUploadEx)})}(i);else g()}function v(e){var t=void 0,a=c();if("question"==T){var n=l();if((t=$("#"+n.picShowWrap).find("img").length)+e>a)return s("鎻愰棶鏈€澶氬彧鑳戒笂浼�"+a+"寮犲浘鐗�"),!1;t+e==a&&$("#"+n.add).hide()}return!0}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var k=a(0),C=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),j=function(){function e(){n(this,e),this.$wrap=$("#wrap"),this._input=$(".tag_search_inp"),this._container=$(".tag_search_box")}return C(e,[{key:"searchTopic",value:function(e,t,a){$.ajax({type:"GET",cache:!1,url:(window.location.protocol.indexOf("https")>-1?"https://wenwenapi.sogou.com/suggsearch":"http://sugg.search.wenwen.sogou.com")+"/sugg/ajaj_json.jsp?type=wentag&key="+e+"&src=qun.tag&ret_type=ret_jsonp&_"+Math.random(),dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpcallback",success:function(e){if(e&&e.result&&$.isArray(e.result)){var n=e.result;if(n.length){t(n);for(var i=$(".select_tags"),r=i.find(".select_tag"),o=$(".tag_search_box"),s=0;s<r.length;s++){var l=$(r[s]).data("cid");o.find(".can_add_tag[data-cid="+l+"]").remove()}o.find("li").length||a()}else a()}}})}},{key:"controlHandler",value:function(e){var t=this._container.find("li.can_add_tag"),a=t.length;if(!a)return!1;var n=t.filter(".cur"),i=null;40===e?(i=n.length&&n.index()!==a-1?n.next():t.first(),this.mouseoutHandler(n),this.mouseoverHandler(i)):(i=n.length&&0!==n.index()?n.prev():t.last(),this.mouseoutHandler(n),this.mouseoverHandler(i)),this._input.val(i.text())}},{key:"mouseoverHandler",value:function(e){e.addClass("cur")}},{key:"mouseoutHandler",value:function(e){e.removeClass("cur")}},{key:"init",value:function(){var e=this;e.$wrap.on("click input propertychange",".tag_search_inp",function(){var t=$(this),a=$.trim(t.val()),n=$(".tag_search_box"),i=$(".tag_search_wrap");if(n.html("").hide(),$(".select_tags").removeClass("ipt-err"),a.length){var r=n.find(".no_tags");e.searchTopic(a,function(e){for(var a="",r=0,o=e.length;r<o;r++){var s=e[r];a+='<li class="can_add_tag" data-cid="'+s.id+'" data-name="'+s.name+'"><a href="javascript:;">'+s.name+'<i class="popup-lst-add" title="娣诲姞"></i></a></li>'}n.html(a).show(),$(".can_add_tag").on("click",function(){var e=$(this),a=$(".select_tags");i.before('<span class="ipt-tag select_tag remove_parent" data-cid="'+e.data("cid")+'"><span>'+e.data("name")+'</span><a href="javascript:;" class="remove_item"><i></i></a></span>'),e.remove(),n.html("").hide(),t.val(""),a.find(".select_tag").length>=3&&i.addClass("ipt-dim").find(".tag_search_inp").attr("disabled","disabled").val("鏁伴噺宸茶揪涓婇檺"),DT.reportCLK("ww.twy.djbq")})},function(){r.length||n.html('<li class="no_tags"><a href="javascript:;" class="no-match-tag" style="line-height: 18px;height:auto;padding:8px 0;">娌℃湁鎵惧埌鍚堥€傜殑鍒嗙被~<br>鎹釜鍒嗙被璇曡瘯鍚�</a></li>').show()})}}).on("blur",".tag_search_inp",function(){var e=$(".select_tags");e.removeClass("ipt-cur").addClass("ipt-default"),e.find(".select_tag").length<3&&$(this).val("")}).on("keyup paste",".tag_search_inp",function(t){var a=t.keyCode||t.which;40===a||38===a?e.controlHandler(a):13===a&&e._container.find("li").filter(".cur").trigger("click")}),e.$wrap.on("click",".select_tags",function(){$(".tag_search_wrap").length&&!$(".tag_search_wrap").hasClass("ipt-dim")&&($(".tag_search_inp").focus(),$(this).removeClass("ipt-default").addClass("ipt-cur")),DT.reportCLK("ww.twy.ssbq")})}}]),e}(),x=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),O=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),x(t,[{key:"handleClick",value:function(){$("#validCode_img").attr("src","/wapi/ms/captcha?_"+Math.random())}},{key:"render",value:function(){var e=this;return Object(k.h)("div",null,Object(k.h)("div",{className:"popup-tit"},"楠岃瘉鐮�"),Object(k.h)("div",{className:"verify-box"},Object(k.h)("div",{className:"btn-verify"},Object(k.h)("input",{type:"text",placeholder:"杈撳叆楠岃瘉鐮�",id:"validCode"})),Object(k.h)("a",{href:"javascript:;",className:"verify-thumb",onClick:function(t){return e.handleClick(t)}},Object(k.h)("img",{src:"/wapi/ms/captcha?_"+Math.random(),width:"92",height:"36",alt:"楠岃瘉鐮�",id:"validCode_img"})),Object(k.h)("div",{className:"verify-txt"},"鐪嬩笉娓呮? ",Object(k.h)("a",{href:"javascript:;",onClick:function(t){return e.handleClick(t)}},"鎹竴寮�"))))}}]),t}(k.Component),T=void 0,P=!0,E=function(e,t){var a=t?e:f(e),n=l(),i=$("#"+n.picShowWrap);if("string"==typeof a){P=!0;var r='<div class="pic-section ask_image_item ask_images remove_parent"><a href="javascript:;" class="pic-tab"><img class="upPic" src="'+a+'" alt="涓婁紶涓�..." style="height: 120px"><span class="pic-close remove_item">脳</span></a></div>';if(i.find(".load_image").length||i.find(".fail_image").length){(i.find(".load_image").length?i.find(".load_image").first():i.find(".fail_image").first()).replaceWith(r)}else i.removeClass("hide").find(".add_ask_image").before(r);var o=i.find("img").length;$("#ask_uploadImage_num").text(c()-o),o===c()&&$(".add_ask_image").addClass("dim")}else i.find(".ask_image_item").length<5&&i.removeClass("hide").find(".add_ask_image").before('<div class="pic-section ask_image_item fail_image"><a href="javascript:;" class="pic-tab-prompt"><i></i>涓婁紶澶辫触</a></div>'),window.badjs.report(new Error("upload image fail! PC"+e),EX_TYPE.imgUploadEx);$(".add_pic").addClass("hide"),u(),g()},I=function(e){g(),window.badjs.report(new Error("upload image fail! PC"+e),EX_TYPE.imgUploadEx)},M=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),q=5,L=function(e){function t(e){_(this,t);var a=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={isChecked:a.props.isLogin&&!a.props.bindPhone||a.props.isLogin&&a.props.bindPhone&&a.props.userMoney>=q},a}return b(t,e),M(t,[{key:"componentDidMount",value:function(){var e=this.state.isChecked,t=this.props.bindPhone;if(e&&t){var a=$(".userMoney").text();$(".userMoney").text(parseInt(a)-5)}}},{key:"handleClick",value:function(e){var t=this,a=this.props,n=a.userMoney,i=a.isLogin,r=a.bindPhone,o=$(".score_val").text();if(i&&r&&(n<q||n-o<5))return pageUtils.Dialog.showTips("闂眴涓嶈冻锛屾棤娉曚娇鐢ㄨ鏈嶅姟!",{remove:!0}),void this.setState({isChecked:!1});this.setState({isChecked:e.target.checked},function(){if(r)if(t.state.isChecked){var e=$(".userMoney").text();$(".userMoney").text(parseInt(e)-5),DT.reportCLK("ww.twy.text.kq")}else{var a=$(".userMoney").text();$(".userMoney").text(parseInt(a)+5),DT.reportCLK("ww.twy.text.gb")}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.isLogin,n=t.userMoney,i=t.bindPhone,r=this.state.isChecked;return Object(k.h)("div",null,a?i?Object(k.h)("div",null,Object(k.h)("input",{type:"checkbox",checked:r,id:"edit",className:n<q?"dim":"",onChange:function(t){return e.handleClick(t)}}),Object(k.h)("label",{htmlFor:"edit",id:"sms_text",className:n<q?"dim":""},"鏈夊洖绛斿厤璐瑰彂鐭俊鑷�",Object(k.h)("em",{className:"phone-num"},i),Object(k.h)("span",{className:"phone-cost"},Object(k.h)("i",{className:"ico-popup-reward"}),"5"))):Object(k.h)("div",null,Object(k.h)("input",{type:"checkbox",checked:r,id:"edit",onChange:function(t){return e.handleClick(t)}}),Object(k.h)("label",{htmlFor:"edit",id:"sms_text"},"鏈夊洖绛斿厤璐瑰彂鐭俊鑷崇粦瀹氭墜鏈�"),Object(k.h)("span",{className:"phone-cost"},Object(k.h)("i",{className:"ico-popup-reward"}),"5")):Object(k.h)("div",null,Object(k.h)("input",{type:"checkbox",id:"edit",checked:r,onChange:function(t){return e.handleClick(t)}}),Object(k.h)("label",{htmlFor:"edit",id:"sms_text"},"鏈夊洖绛斿厤璐瑰彂鐭俊鑷崇粦瀹氭墜鏈�"),Object(k.h)("span",{className:"phone-cost"},Object(k.h)("i",{className:"ico-popup-reward"}),"5")))}}]),t}(k.Component),S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();Function.prototype.clone=function(){var e=this,t=function(){return e.apply(this,arguments)};for(var a in this)t[a]=this[a];return t};var H=function(){},U=!0,W=function(){function e(){y(this,e)}return D(e,null,[{key:"showErrMsg",value:function(e,t){var a=$("#ask_title"),n=$(".err_tips");setTimeout(function(){t&&(a=t,n=t.parent().find(".err_tips")),n.html(e).removeClass("hide"),a.parent().addClass("ipt-err"),a.focus()},100),setTimeout(function(){n.addClass("hide")},3e3)}},{key:"validateContent",value:function(){var e=this,t=$("#ask_title"),a=$("#ask_content"),n=$(".select_tags"),i=$.trim(t.val()),r=$.trim(a.val()),o=n.find(".select_tag").length;if(0===i.length)return e.showErrMsg("鎮ㄨ繕娌℃湁杈撳叆鎻愰棶鍐呭鍝�"),!1;if(i.length<4)return e.showErrMsg("鎻愰棶瀛楁暟澶皯鍟︼紝缃戝弸娌″姙娉曞府鎮ㄨВ绛旓紝蹇ˉ鍏呬竴涓嬪惂"),!1;if(i.length>40)return e.showErrMsg("鎻愰棶瀛楁暟澶鍟︼紝璇风簿绠€涓€涓嬪惂"),!1;if(r.length>200)return e.showErrMsg("闂琛ュ厖瀛楁暟澶鍟︼紝璇风簿绠€涓€涓嬪惂",a),!1;if(!new RegExp(".*[^ -/:-@[-`{-~\t\r\n銆傦紝锛燂紒銆侊紱锛氣€溾€濃€樷€櫬仿р棊锛冿紖鈥︹€烩€旓骏銆娿€嬶紙锛夈€愩€戙€庛€忥紜锛嵜椕凤紳锝瀅.*").test(i))return e.showErrMsg("浣犺緭鍏ョ殑璇箟涓嶅娓呮櫚锛岃姝ｇ‘浣跨敤鍦扮悆璇█"),!1;if(0===o)return pageUtils.Dialog.showTips("闂蹇呴』瑕佹湁鍒嗙被鍝︼紝蹇负瀹冩壘鍒板悎閫傜殑鍒嗙被鍚�",{remove:!0,type:"white",popup:$(".select_tags")}),n.addClass("ipt-err"),$(".tag_search_inp").focus(),!1;var s=$("#validCode");return!(s.length&&$.trim(s.val()).length<4)||(pageUtils.Dialog.showTips("璇疯緭鍏ユ纭殑楠岃瘉鐮�",{remove:!0}),s.focus(),!1)}},{key:"submitAsk",value:function(t,a){var n={userId:_gtag.userId,clbUid:_gtag.uid,orig:_gtag.orig,mobileSmsFlag:$("#edit").is(":checked"),content:pageUtils.Base64(t.content),title:pageUtils.Base64(t.title),tags:t.tags,images:t.images,score:t.score,anonymous:t.anonymous};"edit"===a&&(n.questionId=_gtag.id),_gtag.helperSelf||(n.seekHelpUid=pageTools.getQueryString("uid"));var i=$("#validCode");i.length&&(n.code=pageUtils.Base64(i.val()));var r=!0;if(!r)return!1;r=!1,$.ajax({type:"POST",url:"/submit/ms/ask",data:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){if(!n||"object"!==(void 0===n?"undefined":S(n)))return window.badjs.report(new Error("get pc /submit/ms/ask data not object fail!")),!1;if(0===n.code)"edit"===a?($("#ask_pop, #mask").remove(),pageUtils.Dialog.showTips("淇敼鎴愬姛",{remove:!0,callback:function(){window.location.href="/question/?qid="+n.id}})):window.location.href="/question/?qid="+n.id;else if(-2===n.code||-102===n.code)WKSSO.insureLoginAction(function(){e.submitAsk(t,a)});else if(-5===n.code){pageUtils.Dialog.showTips("楠岃瘉鐮侀敊璇紒",{remove:!0});var r=document.getElementById("validCodeWrap");r.innerHTML="",Object(k.render)(Object(k.h)(O,null),r),i.val("").focus(),_gtag.captcha=!0}else if(-203===n.code){if(pageUtils.Dialog.showTips("鎮祻鍊间笉澶熷摝",{remove:!0}),n.score&&"number"==typeof n.score&&($(".userMoney").text(n.score),_gtag.captcha&&"edit"!==a)){var o=document.getElementById("validCodeWrap");o.innerHTML="",Object(k.render)(Object(k.h)(O,null),o),i.val("")}}else if(-241===n.code)pageUtils.Dialog.showTips("浠婃棩鎻愰棶宸茶揪涓婇檺锛岃鏄庡ぉ鍐嶆潵鍝�",{remove:!0});else if(-243===n.code)pageUtils.Dialog.showTips("鎮ㄧ殑璐㈠瘜鍊间笉瓒�",{remove:!0});else if(pageUtils.Dialog.showTips(pageTools.showCodeMessage(n.code,n.message),{remove:!0,callback:function(){-401===n.code&&"edit"===a&&(window.location.href="/cate/home")}}),_gtag.captcha&&"edit"!==a){var s=document.getElementById("validCodeWrap");s.innerHTML="",Object(k.render)(Object(k.h)(O,null),s),i.val("").focus()}},complete:function(){r=!0},error:function(){pageUtils.Dialog.showTips("鎶辨瓑锛岄亣鍒伴棶棰樻棤娉曟彁浜わ紝璇峰埛鏂伴〉闈㈤噸璇曪紒",{remove:!0})}})}},{key:"showAskPop",value:function(){var e=$("#ask_pop");e.length&&(pageUtils.Mask.show(),e.removeClass("hide"));var t=$("#question_content").text(),a=$("#question_score").length?parseInt($("#question_score").text()):0;t.length&&$("#ask_content").val(t).trigger("click").focus(),a>0&&$(".score_val").text(a),DT.reportCLK("ww.xqy.bjwt")}},{key:"sameQuestion",value:function(e){var t=!0;if(!t)return!1;t=!1,$.ajax({type:"GET",url:"/s/ms-search/?=",data:{w:e,len:5},dataType:"json",success:function(e){var t=$(".same_question_box");if(e&&e.length>0){for(var a="",n=0,i=e.length;n<i;n++){var r=e[n];a+='<li><a href="'+r.link+(r.link.indexOf("?")>-1?"&":"?")+'ch=ww.twy.wttj" target="_blank"><span>'+r.answerNum+"鍥炵瓟</span>"+r.title+"</a></li>"}$(".same_question_list").html(a),t.removeClass("hide")}else t.addClass("hide")},complete:function(){t=!0},error:function(){}})}},{key:"titleTags",value:function(e){var t=!0;if(!t)return!1;t=!1,$.ajax({type:"GET",url:"/wapi/ms/title-tags",data:{title:e},dataType:"json",success:function(e){if(e.length>0){var t=$(".select_tags");if(0===t.find(".select_tag").length){var a=e.length>3?3:e.length;3===a&&$(".tag_search_wrap").addClass("ipt-dim").find(".tag_search_inp").attr("disabled","disabled").val("鏁伴噺宸茶揪涓婇檺");for(var n=a-1;n>=0;n--){var i=e[n];t.prepend('<span class="ipt-tag select_tag remove_parent" data-cid="'+i.id+'"><span>'+i.name+'</span><a href="javascript:;" class="remove_item"><i></i></a></span>')}}}},complete:function(){t=!0},error:function(){}})}},{key:"uploadImageEventInit",value:function(){var e=$("#uploadImgIfr");$("#uploadImgIfr").off("error").on("error",function(){s("鍥剧墖涓婁紶澶辫触锛岃閲嶆柊涓婁紶锛�"),$("#uploadImgForm")[0].reset()});var t={};e.on("load",function(){try{t.uploadingImage=!0;var a=e[0].contentDocument||e[0].contentWindow.document,n=a.body,i=JSON.parse(n.innerHTML);if("object"!==(void 0===i?"undefined":S(i))||"string"==typeof i.fname&&i.fname.length<=8)return window.badjs.report(new Error("ie8 upload image failed!")),t.uploadingImage=!1,!1;var r=i.fname,o="//pic.wenwen.soso.com/p/"+r.substr(0,8)+"/"+r,s='<div class="pic-section ask_images remove_parent"><a href="javascript:;" class="pic-tab"><img class="upPic" src="'+o+'" alt="涓婁紶涓�..." style="height: 120px"><span class="pic-close remove_item">脳</span></a></div>';$("#picShowWrap").removeClass("hide").find(".picWrap").append(s),$(".add_pic").addClass("hide"),t.uploadingImage=!1,$("#uploadImgForm")[0].reset()}catch(e){}}),$("#pic").off("change").on("change",function(e){e.preventDefault(),e.stopPropagation();try{if(this.files&&window.FormData)d("question"),m(this.files);else{if(!/\.(gif|jpg|bmp|png|GIF|JPG|PNG|BMP)$/.test(this.value))return s("鍥剧墖鏍煎紡蹇呴』涓簀pg/gif/bmp/png鍝�"),$("#uploadImgForm")[0].reset(),!1;$("#uploadImgForm").submit()}}catch(e){}return DT.reportCLK("ww.twy.tjtp"),!1}),$(".add_ask_image").on("click",function(){if($(this).hasClass("dim"))return pageUtils.Dialog.showTips("鏈€澶氬彧鍙笂浼�5寮犵収鐗囧摝~",{remove:!0,type:"white",popup:$(".add_ask_image")}),!1;$("#pic").trigger("click")})}},{key:"editQuestion",value:function(){_gtag.isLogin?e.showAskPop():$("#s_login").trigger("click"),$("#askPop_close").on("click",function(){pageUtils.Mask.close(),$("#ask_pop").addClass("hide")})}},{key:"controlHandler",value:function(e){var t=this,a=$(".same_question_list").find("li"),n=a.length;if(!n)return!1;var i=a.filter(".cur"),r=null;40===e?(r=i.length&&i.index()!==n-1?i.next():a.first(),t.mouseoutHandler(i),t.mouseoverHandler(r)):(r=i.length&&0!==i.index()?i.prev():a.last(),t.mouseoutHandler(i),t.mouseoverHandler(r))}},{key:"mouseoverHandler",value:function(e){e.addClass("cur")}},{key:"mouseoutHandler",value:function(e){e.removeClass("cur")}},{key:"init",value:function(){var t=this,a=$("#validCodeWrap");if(_gtag.isLogin&&_gtag.captcha&&a.length){var n=document.getElementById("validCodeWrap");n.innerHTML="",Object(k.render)(Object(k.h)(O,null),n)}$("#submit_question").on("click",function(){var t=$("#ask_pop").attr("data-type"),a=$("#ask_title"),n=$.trim(a.val()),i=$.trim($("#ask_content").val()),r=[],o=[];if($(".select_tag").each(function(){r.push($(this).data("cid"))}),$(".ask_images").each(function(){o.push($(this).find("img.upPic").attr("src"))}),!e.validateContent(t))return!1;var s={title:n,content:i,tags:r,images:o,score:$.trim($(".score_val").text()),anonymous:$("#ask_anonymous").prop("checked")};WKSSO.insureLoginAction(function(){window.RNV(null,function(){e.submitAsk(s,t)},!0).verify()}),DT.reportCLK("ww.twy.tjwt")});var i=$("#wrap");i.on("click input propertychange",".textarea",function(){var t=$(this),a=t.val(),n=a.length,i=$("#ask_title"),r=t.data("maxlength");n>r?(t.parent().find(".wordsLimit").html('宸茬粡瓒呭嚭<em class="emphasis-clr2">'+(n-r)+"</em>涓瓧"),t.parent().removeClass("ipt-cur").addClass("ipt-err")):0===n?(t.parent().addClass("ipt-default").addClass("ipt-cur"),t.parent().find(".wordsLimit").html("杩樺彲浠ヨ緭鍏�<em>"+(r-n)+"</em>涓瓧"),U=!0):(t.parent().find(".wordsLimit").html("杩樺彲浠ヨ緭鍏�<em>"+(r-n)+"</em>涓瓧"),t.parent().removeClass("ipt-default").removeClass("ipt-err").addClass("ipt-cur")),"ask_title"===t.attr("id")&&($.trim(i.val()).length>=4&&U?setTimeout(function(){e.sameQuestion(i.val())},300):$(".same_question_box").addClass("hide"))}).on("blur",".textarea",function(){var t=$(this);if(t.parent().removeClass("ipt-cur"),"ask_title"===t.attr("id")){var a=$.trim(t.val());$.trim(a).length>0&&e.titleTags(a)}});var r=$("#ask_title"),o=pageTools.getQueryString("w");null!==o&&o.length>0&&r.val(decodeURI(o)),r.focus().trigger("click"),r.on("keyup paste",function(e){var a=e.keyCode||e.which;if(40===a||38===a)t.controlHandler(a);else if(13===a){var n=$(".same_question_list").find("li.cur");n.length&&window.open(n.find("a").attr("href"))}}),DT.reportCLK("ww.header.wytw"),i.on("click",".remove_item",function(e){var t=$(e.target).closest("#picShowWrap");if(t.length){var a=$("#addPic");a.is(":visible")||a.show();var n=t.find("img").length;$("#ask_uploadImage_num").text(6-n),$(".add_ask_image").removeClass("dim"),1===t.find(".ask_image_item").length&&(t.addClass("hide"),$(".add_pic").removeClass("hide")),DT.reportCLK("ww.twy.sctp")}if($(e.target).closest(".select_tags").length){var i=$(".tag_search_wrap");i.hasClass("ipt-dim")&&i.removeClass("ipt-dim").find(".tag_search_inp").removeAttr("disabled").val(""),DT.reportCLK("ww.twy.scbq")}$(this).closest(".remove_parent").remove()}),i.on("click",".select_score",function(){var e=$(this),t=e.closest("#ask_pop").data("type"),a=$(".score_val").data("oldscore"),n=parseInt($(".userMoney").text()),i=$(".score_list");if(e.parent().hasClass("dim"))return!1;i.find(".score_sel").each(function(){var e=$(this).parent(),i=parseInt(e.text());"edit"===t?(a+n<i||i<a)&&e.remove():i>n?e.addClass("dim"):e.removeClass("dim")}),i.addClass("on"),DT.reportCLK("ww.twy.xs")});var s=$(".same_question_box");$(document).on("click",function(e){!s.is(":visible")||$(e.target).closest(".same_question_box").length&&!$(e.target).closest(".close_same_question").length||(s.addClass("hide"),U=!1,DT.reportCLK("ww.tw.gb"));var t=$(e.target).closest(".score_sel");if(t.parent().hasClass("dim"))return!1;if(t.length&&($(".score_val").text(t.text()),_gtag.bindPhone)){var a=parseInt($(".score_val").text()),n=parseInt($(".userMoney").text()),i=$("#edit").prop("checked"),r=$("#edit");i||(a+5>n?(r.prop("checked",!1),r.addClass("dim"),$("#sms_text").addClass("dim")):(r.removeClass("dim"),$("#sms_text").removeClass("dim")))}$(e.target).closest(".select_score").length||$(".score_list").removeClass("on"),$(e.target).closest(".tag_search_box").length||$(".tag_search_box").html("").hide()}),(new j).init(),$("#ask_anonymous").on("click",function(){DT.reportCLK("ww.twy.nm")}),$("#modify_question").on("click",function(){e.editQuestion()}),Object(k.render)(Object(k.h)(L,{isLogin:_gtag.isLogin,bindPhone:_gtag.bindPhone,userMoney:_gtag.userMoney}),document.getElementById("smsVerify")),e.uploadImageEventInit(function(){window.Editor.Image.showPreview=H,$("#uploadImgForm")[0].reset()})}}]),e}();$(function(){_gtag.isLogin||$("#s_login").trigger("click"),W.init()})}]);
//# sourceMappingURL=main_4e5e2cd.js.map